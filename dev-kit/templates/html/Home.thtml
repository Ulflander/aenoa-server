<?php
	$projectNumAtInit = 6 ;
?>

<form id="projects-home" method="post">
	<div id="yop" class="col-12 extended unmarged line100">
	<h3 class="col-12">Recent projects</h3>
	<hr class="hidden thin" />
	<?php
		foreach ( $recent_projects as $project ):
		if ( $project->valid && $project->isLocked () == false ): ?>
	<div class="col-4 b p p-5 sans-serif left lined <?php echo $project->class ?> margedbottom bordertop r-2">
		<h3>
			<?php echo $project->name ?>
		</h3>
		<span class="minimized">
			<?php echo $project->type ?>
			project 
			<?php echo ( $project->getCVSTag () != '' ? ' | CVS tag: ' . $project->getCVSTag () : '&nbsp;' ) ; ?>
		</span>
		<hr/>
		<ul class="inline">
			<li>
				<a href="<?php echo url() ?>ManageProject:<?php echo $project->name ?>" class="icon16 manage">Manage</a>
			</li>
			<li>
				<a href="<?php echo $project->URL ?>" target="_blank" class="icon16 network">Visit</a>
			</li>
			<li class="ddmenu-container">
				<span class="icon16 menu undecorated">or run...</span>
				<ul class="ddmenu on-top b light-shadowed r-5 light-block" style="z-index: 2000">
					<li>
						<a href="<?php echo url() ?>ManualBackup:<?php echo $project->name ?>/Home" class="icon16 backup r-5 r-top">ManualBackup</a>
					</li>
					<li>
						<a href="<?php echo url() ?>AutoBackup:<?php echo $project->name ?>/Home" class="icon16 backup">AutoBackup</a>
					</li>
					<?php if ( $project->type == DevKitProjectType::AENOA ): ?>
					<li>
						<a href="#" class="green-block icon16 aenoa r-5 r-bottom">Aenoa</a>
						<ul class="ddmenu b light-shadowed r-5 green-block">
							<li>
								<a href="<?php echo url() ?>CreateServiceDescription:<?php echo $project->name ?>" class="icon16 service r-5">CreateServiceDescription</a>
							</li>
							<li>
								<a href="<?php echo url() ?>I18nExtraction:<?php echo $project->name ?>" class="icon16 i18n r-5">I18nExtraction</a>
							</li>
							<li>
								<a href="<?php echo url() ?>AenoaCompile:<?php echo $project->name ?>" class="icon16 compile r-5 r-bottom">AenoaCompile</a>
							</li>
						</ul>
					</li>
					<?php elseif ( $project->type == DevKitProjectType::AENOA_PLUGIN ): ?>
					<li>
						<a href="#" class="orange-block icon16 aenoa r-5 r-bottom">Aenoa SDK Plugin</a>
						<ul class="ddmenu b light-shadowed r-5 orange-block">
							<li>
								<a href="<?php echo url() ?>PluginConfig:<?php echo $project->name ?>" class="icon16 run r-5">PluginConfig</a>
							</li>
							<li>
								<a href="<?php echo url() ?>EditPluginProject:<?php echo $project->name ?>" class="icon16 file_php r-5">EditPluginProject</a>
							</li>
							<li>
								<a href="<?php echo url() ?>TestPlugin:<?php echo $project->name ?>" class="icon16 test r-5 r-bottom">TestPlugin</a>
							</li>
							<li>
								<a href="<?php echo url() ?>PackageAndPublishPlugin:<?php echo $project->name ?>" class="icon16 package r-5 r-bottom">PackageAndPublishPlugin</a>
							</li>
							<li>
								<a href="<?php echo url() ?>DeployProjectAsPlugin:<?php echo $project->name ?>" class="icon16 install r-5 r-bottom">DeployProjectAsPlugin</a>
							</li>
						</ul>
					</li>
					<?php endif; ?>
					<li>
						<a href="<?php echo url() ?>RunTask:<?php echo $project->name ?>/Home" class="icon16 run">RunTask</a>
					</li>
					<li>
						<a href="<?php echo url() ?>LockProject:<?php echo $project->name ?>/Home" class="icon16 lock">LockProject</a>
					</li>
					<li>
						<a href="<?php echo url() ?>TrashProject:<?php echo $project->name ?>/Home" class="icon16 trash_empty">TrashProject</a>
					</li>
				</ul>
			</li>
		</ul>
	</div>
	<?php
		endif;
		endforeach; ?>
	<hr class="col-12" /><h3 class="col-12 margedbottom">All projects</h3>
	<?php
		// ALL PROJECTS LOOP
		foreach ( $projects as &$project ): ?>
	<?php if ( $project->isLocked () == false ): ?>
	<div id="proj-<?php echo $project->name ?>" class="col-4 p p-5 lined sans-serif left <?php echo $project->class ?> margedbottom b bordertop r-2">
		<h3>
			<?php echo $project->name ?>
		</h3>
		<span class="minimized">
			<?php echo $project->type ?>
			project 
			<?php echo ( $project->getCVSTag () != '' ? ' | CVS tag: ' . $project->getCVSTag () : '&nbsp;' ) ; ?>
		</span>
		<input type="checkbox" id="<?php echo $project->name ?>" name="<?php echo $project->name ?>" class="right unmarged" /><hr/>
		<?php else: ?>
		<div id="proj-<?php echo $project->name ?>" class="col-4 p lined sans-serif left red-block bordertop r-2 icon lock margedbottom" style="display: none;">
			<h3 class="red-text col-3 col-last unmarged unp unindented">
				<?php echo $project->name ?>
			</h3>
			<span class="minimized col-3 col-last">
				<?php echo $project->type ?>
				project</span>
			<hr class="col-3 col-last" />
			<?php endif; ?>
			<ul class="inline">
				<?php if ( $project->isLocked () == false ): ?>
				<li>
					<a href="<?php echo url() ?>ManageProject:<?php echo $project->name ?>" class="icon16 manage">Manage</a>
				</li>
				<li>
					<a href="<?php echo $project->URL ?>" target="_blank" class="icon16 network">Visit</a>
				</li>
				<li class="ddmenu-container">
					<span class="icon16 menu undecorated">or run...</span>
					<ul class="ddmenu on-top b light-shadowed r-5 light-block" style="z-index: 2000">
						<li>
							<a href="<?php echo url() ?>ManualBackup:<?php echo $project->name ?>/Home" class="icon16 backup r-5 r-top">ManualBackup</a>
						</li>
						<li>
							<a href="<?php echo url() ?>AutoBackup:<?php echo $project->name ?>/Home" class="icon16 backup">AutoBackup</a>
						</li>
						<?php if ( $project->type == DevKitProjectType::AENOA ): ?>
						<li>
							<a href="#" class="green-block icon16 aenoa r-5 r-bottom">Aenoa</a>
							<ul class="ddmenu b light-shadowed r-5 green-block p line35">
								<li class="">
									<a href="<?php echo url() ?>CreateServiceDescription:<?php echo $project->name ?>" class="icon16 service r-5">CreateServiceDescription</a>
								</li>
								<li class="">
									<a href="<?php echo url() ?>I18nExtraction:<?php echo $project->name ?>" class="icon16 i18n r-5">I18nExtraction</a>
								</li>
								<li class="">
									<a href="<?php echo url() ?>AenoaCompile:<?php echo $project->name ?>" class="icon16 compile r-5 r-bottom">AenoaCompile</a>
								</li>
							</ul>
						</li>
						<?php elseif ( $project->type == DevKitProjectType::AENOA_PLUGIN ): ?>
						<li>
							<a href="#" class="orange-block icon16 aenoa r-5 r-bottom">Aenoa SDK Plugin</a>
							<ul class="ddmenu b light-shadowed r-5 orange-block">
								<li>
									<a href="<?php echo url() ?>PluginConfig:<?php echo $project->name ?>" class="icon16 run r-5">PluginConfig</a>
								</li>
								<li>
									<a href="<?php echo url() ?>EditPluginProject:<?php echo $project->name ?>" class="icon16 file_php r-5">EditPluginProject</a>
								</li>
								<li>
									<a href="<?php echo url() ?>TestPlugin:<?php echo $project->name ?>" class="icon16 test r-5 r-bottom">TestPlugin</a>
								</li>
								<li>
									<a href="<?php echo url() ?>PackageAndPublishPlugin:<?php echo $project->name ?>" class="icon16 package r-5 r-bottom">PackageAndPublishPlugin</a>
								</li>
								<li>
									<a href="<?php echo url() ?>DeployProjectAsPlugin:<?php echo $project->name ?>" class="icon16 install r-5 r-bottom">DeployProjectAsPlugin</a>
								</li>
							</ul>
						</li>
						<?php endif; ?>
						<li>
							<a href="<?php echo url() ?>RunTask:<?php echo $project->name ?>/Home" class="icon16 run">RunTask</a>
						</li>
						<li>
							<a href="<?php echo url() ?>LockProject:<?php echo $project->name ?>/Home" class="icon16 lock">LockProject</a>
						</li>
						<li>
							<a href="<?php echo url() ?>TrashProject:<?php echo $project->name ?>/Home" class="icon16 trash_empty">TrashProject</a>
						</li>
					</ul>
				</li>
				<?php else: ?>
				<li class="margedleft">
					<a href="<?php echo url() ?>UnlockProject:<?php echo $project->name ?>" class="icon16 unlock">Unlock</a>
				</li>
				<?php endif; ?>
			</ul>
		</div>
		<?php
		// ALL PROJECTS LOOP ENDS HERE
		endforeach; ?>
		<hr class="col-12" />
		
		<input onclick="javascript:submitForm('projects-home','<?php echo url() ; ?>TrashProjects');" type="submit" value="Trash selected" class="right margedright icon16 trash_empty" /><input onclick="javascript:submitForm('projects-home','<?php echo url() ; ?>BackupProjects');" type="submit" value="Backup selected" class="right icon16 backup" />
	</div>
</form>
<div id="sidebar" class="col-4 unmarged right no-list-style">

	<div class="light-block p bordertop margedbottom r-2">
		<h3 class="icon add">Quick Create</h3>
		<div class=" margedbottom">
			<form action="<?php echo url() ?>Create" method="post">
				<div class="margedleft">
					Project name:
				</div>
				<input type="text" id="name" name="name" class="margedtop" />
				<br/>
				<input type="submit" value="Create !" class="margedtop" />
			</form>
		</div>
	</div>
	<div class="light-block p bordertop margedbottom r-2">
		<h3 class="icon backup">Backup</h3>
		<ul class="margedleft margedbottom">
			<li>
				<a href="<?php echo url() ?>ExploreBackups">Explore backups</a>
			</li>
			<li>
				<a href="<?php echo url() ?>GlobalBackup">Backup all</a>
			</li>
		</ul>
	</div>
	<div class="light-block p bordertop margedbottom r-2">
		<h3 class="icon run">Manage</h3>
		<ul class="margedleft margedbottom">
			<li>
				<a href="<?php echo url() ?>TaskCenter">Task Center</a>
			</li>
			<li>
				<a href="<?php echo url() ?>ExploreTrash">Open Trash</a>
			</li>
		</ul>
	</div>
	
    <div class="green-block p bordertop icon folder margedbottom">
    	<?php 
			$url = url() . 'PHPInfo' ;
			$projects = array ('aenoa-server', 'acf', 'ajsf', 'static') ;
			foreach( $projects as $proj ) {
				$url .= '/AutoBackup:'.$proj .
				'/CleanFiles:'.$proj .
				'/GenerateIconifyPlugin:'.$proj .
				'/GenerateDocumentation:'.$proj .
				'/CheckForAenoaProductPackage:'.$proj .
				'/ZipProjectAsAenoa:'.$proj  .
				'/SendProjectToAenoaFTP:'.$proj ;
			}
		?>
    	<a href="<?php echo $url ?>"><h3>Package as Aenoa</h3>
                <div class="right col-2 minimized bold">
                    Publish all Aenoa products
                </div>
            </a>
    </div>
</div>
